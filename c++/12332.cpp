#include <bits/stdc++.h>
typedef long long ll;
using namespace std;

// vector<string> ans={
// "Case #1: 18",
// "Case #2: 18",
// "Case #3: 19",
// "Case #4: 18",
// "Case #5: 19",
// "Case #6: 18",
// "Case #7: 12",
// "Case #8: 15",
// "Case #9: 20",
// "Case #10: 10",
// "Case #11: 500",
// "Case #12: 131",
// "Case #13: 131",
// "Case #14: 95",
// "Case #15: 95",
// "Case #16: 111",
// "Case #17: 115",
// "Case #18: 7588093446180",
// "Case #19: 19336419062320",
// "Case #20: 82445121328592",
// "Case #21: 737049806193",
// "Case #22: 9298533868440",
// "Case #23: 31176368032514",
// "Case #24: 19384037645139",
// "Case #25: 20574088567305",
// "Case #26: 9653671833041",
// "Case #27: 14428903798188",
// "Case #28: 26310337430020",
// "Case #29: 58176579505687",
// "Case #30: 66704821784096",
// "Case #31: 311834580740",
// "Case #32: 27144041981796",
// "Case #33: 19507031883035",
// "Case #34: 38965677302880",
// "Case #35: 3120586021398",
// "Case #36: 1751104141626",
// "Case #37: 3493626635130",
// "Case #38: 9682879293010",
// "Case #39: 3993874514560",
// "Case #40: 35870165571840",
// "Case #41: 6983382099360",
// "Case #42: 18233557664531",
// "Case #43: 59919507270752",
// "Case #44: 7868302717482",
// "Case #45: 22570921684180",
// "Case #46: 45928884914805",
// "Case #47: 35538448842619",
// "Case #48: 1283517879670",
// "Case #49: 4462278893415",
// "Case #50: 30090234073732",
// "Case #51: 5530069444180",
// "Case #52: 19168015197859",
// "Case #53: 24473307222546",
// "Case #54: 54183710114772",
// "Case #55: 8893251924375",
// "Case #56: 36163507445052",
// "Case #57: 4836158139241",
// "Case #58: 30743854514619",
// "Case #59: 22879282364250",
// "Case #60: 51406333562848",
// "Case #61: 11345705027712",
// "Case #62: 3318313743787",
// "Case #63: 8142111877000",
// "Case #64: 64676427956145",
// "Case #65: 12822546263062",
// "Case #66: 25906953544791",
// "Case #67: 4464356828400",
// "Case #68: 8884450729721",
// "Case #69: 1090392602576",
// "Case #70: 16705223786824",
// "Case #71: 63130634718228",
// "Case #72: 79653174941484",
// "Case #73: 11898351803456",
// "Case #74: 78127421837949",
// "Case #75: 68707302030706",
// "Case #76: 187477236447270",
// "Case #77: 99213355711344",
// "Case #78: 408179768520594",
// "Case #79: 1358275028127866",
// "Case #80: 1668986181530044",
// "Case #81: 50953071082330",
// "Case #82: 476348683260367",
// "Case #83: 2832763964900604",
// "Case #84: 4649214131323244",
// "Case #85: 399659941144941",
// "Case #86: 645599964347088",
// "Case #87: 11574058704647470",
// "Case #88: 2288246795708648",
// "Case #89: 191126724850444",
// "Case #90: 12729928680122472",
// "Case #91: 46625708550000000",
// "Case #92: 20964577424386275",
// "Case #93: 32918125317265544",
// "Case #94: 43141095383972045",
// "Case #95: 58450071207289051",
// "Case #96: 35639184861477888",
// "Case #97: 121172745225992586",
// "Case #98: 148070342709136948",
// "Case #99: 173175088804446246",
// "Case #100: 161472803814628854"
// };

int main(){
    ios_base::sync_with_stdio(false); cin.tie(NULL);
    // freopen("test_data/test_set_2/ts2_input.txt","r",stdin);
    int tc;
    cin >> tc;
    for(int tt=0;tt<tc;tt++){
        ll e,r;
        int n;
        cin >> e >> r >> n;
        vector<ll> v(n);
        vector<int> idx(n,-1);
        stack<int> st;
        for(ll &t:v) cin >> t;
        for(int i=n-1;i>=0;i--){
            while(!st.empty() && v[st.top()]<=v[i]) st.pop();
            if(!st.empty()) idx[i]=st.top();
            st.push(i);
        }
        ll cur=e;
        ll res=0;
        for(int i=0;i<n;i++){
            if(idx[i]==-1){
                res+=cur*v[i];
                cur=min(r,e);
                continue;
            }
            ll req=max(e-r*(ll)(idx[i]-i),0ll);
            ll af=max(cur-req,0ll);
            res+=af*v[i];
            cur=min(cur-af+r,e);
        }
        // string myans="Case #"+to_string(tt+1)+": "+to_string(res);
        // if(ans[tt]!=myans){
        //     cout << tt+1 << '\n';
        //     cout << res;
        //     return 0;
        // }
        cout << "Case #" << tt+1 << ": " << res << '\n';
    }
    return 0;
}